---
title: "barplot_volcanoes"
author: "Annika Weber"
date: "2022-12-12"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(leaflet)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(plotly)
library(forcats)
library(tidyr)

```

```{r}
volcano <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-05-12/volcano.csv')

#filter to Indonesia, select few columns for bar plot, remove plural types 
indonesia_volcanoes2 <- volcano %>% 
  filter(country == "Indonesia") %>% 
  select(subregion, primary_volcano_type) %>% 
  mutate(primary_volcano_type = str_remove(primary_volcano_type, "\\(.*\\)")) 
 
 

volcano_plot <- indonesia_volcanoes2 %>% 
  ggplot(aes(x = subregion)) +
  geom_bar(aes(fill = primary_volcano_type)) +
  theme(axis.text.x = element_text(angle = 50, hjust = 1)) +
  ggtitle("Volcano Counts and Types by Region") +
  labs(x = element_blank(), y = "Number of Volcanoes")
  
                                           
ggplotly(volcano_plot)  

```

